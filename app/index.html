<!doctype html>
<!--suppress HtmlFormInputWithoutLabel -->
<html class="no-js">
<head>
  <meta charset="utf-8">
  <title>Timesheets Plus</title>
  <meta name="description" content="Used to ease time recording">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
  <!-- favicon.ico from http://findicons.com/icon/444035/full_time?id=444149
       Original author: Patricia Clausnitzer
       License: Creative Commons Attribution (by) -->
  <!-- build:css(.) styles/vendor.css -->
  <!-- bower:css -->
  <!-- endbower -->
  <!-- endbuild -->
  <!-- build:css(.tmp) styles/main.css -->
  <link rel="stylesheet" href="styles/main.css">
  <!-- endbuild -->
  <style type="text/css">
    input.ng-invalid {
      background-color : #FA787E;
    }
  </style>
</head>
<body ng-app="gteApp">

<div ng-controller="MainCtrl" class="container-fluid">
  <div class="row">
    <table class="table table-bordered table-striped">
      <thead>
      <tr class="info">
        <th colspan="2">Timer</th>
        <th>Engagement <span ng-click="editTypeaheadEntries = !editTypeaheadEntries"><i class="glyphicon glyphicon-wrench"></i></span></th>
        <th>Activity <span ng-click="editTypeaheadEntries = !editTypeaheadEntries"><i class="glyphicon glyphicon-wrench"></i></span></th>
        <th>Description <span ng-click="editTypeaheadEntries = !editTypeaheadEntries"><i class="glyphicon glyphicon-wrench"></i></span></th>
        <th style="width: 5em">Loc</th>
        <th style="width: 5em">Role</th>
        <th style="width: 5em">Sat</th>
        <th style="width: 5em">Son</th>
        <th style="width: 5em">Mon</th>
        <th style="width: 5em">Tue</th>
        <th style="width: 5em">Wed</th>
        <th style="width: 5em">Thu</th>
        <th style="width: 5em">Fri</th>
        <th style="width: 5em">
          Total
          <span ng-click="roundRows(rowsForGTE)" tooltip="distribute times between days to get only one decimal place"><i class="glyphicon glyphicon-transfer"></i></span>
        </th>
        <th style="width: 5em">Delta</th>
      </tr>
      </thead>
      <form>
        <tbody>
        <tr ng-repeat="row in rowsForGTE">
          <td style="vertical-align: middle; text-align: center; width: 1px;" tooltip="remove row" tooltip-placement="right" tooltip-append-to-body="1">
            <span ng-click="rowsForGTE.splice($index, 1)"><i class="glyphicon glyphicon-remove"></i></span>
          </td>
          <td style="width:7.5em">
            <stopwatch elapsed-time="row.totalTime" toggle-callback="callbackToggleFactory(row, 'totalTime')"
                       start-time="row._startTime" running="row._running">
            </stopwatch>
          </td>
          <td><input type="text" ng-model="row.engagement" typeahead="engagement for engagement in typeahead.engagement | filter:$viewValue | limitTo:8" style="width: 100%"></td>
          <td><input type="text" ng-model="row.activity" typeahead="activity for activity in typeahead.activity | filter:$viewValue | limitTo:8" style="width: 100%"></td>
          <td><input type="text" ng-model="row.description" typeahead="description for description in typeahead.description | filter:$viewValue | limitTo:8" style="width: 100%">
          </td>
          <td><input type="text" ng-model="row.location1" typeahead="location1 for location1 in typeahead.location1 | filter:$viewValue | limitTo:8" style="width: 100%"></td>
          <td><input type="text" ng-model="row.location2" typeahead="location2 for location2 in typeahead.location2 | filter:$viewValue | limitTo:8" style="width: 100%"></td>
          <td><input type="number" step="0.1" ng-model="row.saturday" style="width: 100%"></td>
          <td><input type="number" step="0.1" ng-model="row.sunday" style="width: 100%"></td>
          <td><input type="number" step="0.1" ng-model="row.monday" style="width: 100%"></td>
          <td><input type="number" step="0.1" ng-model="row.tuesday" style="width: 100%"></td>
          <td><input type="number" step="0.1" ng-model="row.wednesday" style="width: 100%"></td>
          <td><input type="number" step="0.1" ng-model="row.thursday" style="width: 100%"></td>
          <td><input type="number" step="0.1" ng-model="row.friday" style="width: 100%"></td>
          <td style="text-align:center">
            {{row.saturday + row.sunday + row.monday + row.tuesday + row.wednesday + row.thursday + row.friday | number:1}}
            <span ng-click="roundRow(row)" tooltip="distribute times between days to get only one decimal place"><i class="glyphicon glyphicon-transfer"></i></span>
          </td>
          <td style="text-align:center">
            {{row.saturday + row.sunday + row.monday + row.tuesday + row.wednesday + row.thursday + row.friday - row.totalTime | number:2}}
            <span ng-hide="$index === 0" ng-click="swapRows(rowsForGTE, $index - 1, $index)" tooltip-placement="left" tooltip="move row up">
              <i class="glyphicon glyphicon-arrow-up"></i>
            </span>
            <span ng-show="$index === 0" ng-click="swapRows(rowsForGTE, $index + 1, $index)" tooltip-placement="left" tooltip="move row down">
              <i class="glyphicon glyphicon-arrow-down"></i>
            </span>
          </td>
        </tr>
        </tbody>
      </form>
      <tfoot>
      <tr class="info">
        <th colspan="2" style="text-align:center">{{getTotalFor(rowsForGTE, 'totalTime') | number:2}}</th>
        <th colspan="3">
          <span ng-repeat="(key, value) in aggregateByType(rowsForGTE)" class="label label-default" style="margin-right:10px;padding-top:6px;padding-bottom:6px;">
            {{key}} <span class="badge" style="background-color:darkblue">{{value | number:1}}</span>
          </span>
        </th>
        <th colspan="2">
          <button class="btn btn-primary btn-xs" ng-click="editTypeaheadEntries = !editTypeaheadEntries">
            Edit auto complete entries
          </button>
        </th>
        <th style="text-align:center">{{getTotalFor(rowsForGTE, 'saturday') | number:1}}</th>
        <th style="text-align:center">{{getTotalFor(rowsForGTE, 'sunday') | number:1}}</th>
        <th style="text-align:center">{{getTotalFor(rowsForGTE, 'monday') | number:1}}</th>
        <th style="text-align:center">{{getTotalFor(rowsForGTE, 'tuesday') | number:1}}</th>
        <th style="text-align:center">{{getTotalFor(rowsForGTE, 'wednesday') | number:1}}</th>
        <th style="text-align:center">{{getTotalFor(rowsForGTE, 'thursday') | number:1}}</th>
        <th style="text-align:center">{{getTotalFor(rowsForGTE, 'friday') | number:1}}</th>
        <th style="text-align:center">{{getTotal(rowsForGTE) | number:1}}</th>
        <th style="text-align:center">{{getTotalDiff(rowsForGTE) | number:2}}</th>
      </tr>
      </tfoot>
    </table>
    <div style="text-align: center">
      <button ng-click="deleteAllRows(rowsForGTE)" style="width: 20%; margin-right: 5%" class="btn btn-danger">Delete all rows</button>
      <button ng-click="addRow()" style="width: 20%; margin-right: 5%" class="btn btn-primary">Add row</button>
      <button ui-zeroclip zeroclip-text="{{jsonForMercury(rowsForGTE)}}" ng-click="exportForMercury()" id="mercury" style="width: 20%; margin-right: 5%"
              class="btn btn-primary">Export for Mercury
      </button>
      <button ng-click="clearTimes(rowsForGTE)" style="width: 20%" class="btn btn-warning">Clear times</button>
    </div>
  </div>
  <div class="row" style="border-top: 5px groove;margin-top:10px" ng-show="editTypeaheadEntries">
    <div class="col-md-3" ng-repeat="(key, entries) in typeahead">
      <h3 style="text-decoration: underline;text-align: center">{{key[0].toUpperCase() + key.substring(1)}}</h3>
      <table class="table table-bordered table-striped">
        <thead>
        <tr class="info">
          <th>{{key[0].toUpperCase() + key.substring(1)}}</th>
          <th>used on</th>
        </tr>
        </thead>
        <tr ng-repeat="entry in entries">
          <td>
            <span ng-click="removeTypeaheadEntry(key, $index, entry)"><i class="glyphicon glyphicon-remove"></i></span>
            {{entry}}
          </td>
          <td style="white-space: nowrap">{{typeaheadLastUsed[key][entry].substring(0, 10)}}</td>
        </tr>
        <tr>
          <td colspan="2" style="vertical-align: middle">
            <textarea ng-model="newEntries" style="width: 100%"></textarea>
            <button class="btn btn-primary" style="width:100%" ng-click="addTypeaheadEntries(key, newEntries)">Add</button>
          </td>
        </tr>
      </table>
    </div>
  </div>
</div>

<!-- build:js(.) scripts/oldieshim.js -->
<!--[if lt IE 9]>
<script src="bower_components/es5-shim/es5-shim.js"></script>
<script src="bower_components/json3/lib/json3.js"></script>
<![endif]-->
<!-- endbuild -->

<!-- build:js(.) scripts/vendor.js -->
<!-- bower:js -->
<script src="bower_components/jquery/dist/jquery.js"></script>
<script src="bower_components/angular/angular.js"></script>
<script src="bower_components/bootstrap-sass-official/assets/javascripts/bootstrap/affix.js"></script>
<script src="bower_components/bootstrap-sass-official/assets/javascripts/bootstrap/alert.js"></script>
<script src="bower_components/bootstrap-sass-official/assets/javascripts/bootstrap/button.js"></script>
<script src="bower_components/bootstrap-sass-official/assets/javascripts/bootstrap/carousel.js"></script>
<script src="bower_components/bootstrap-sass-official/assets/javascripts/bootstrap/collapse.js"></script>
<script src="bower_components/bootstrap-sass-official/assets/javascripts/bootstrap/dropdown.js"></script>
<script src="bower_components/bootstrap-sass-official/assets/javascripts/bootstrap/tab.js"></script>
<script src="bower_components/bootstrap-sass-official/assets/javascripts/bootstrap/transition.js"></script>
<script src="bower_components/bootstrap-sass-official/assets/javascripts/bootstrap/scrollspy.js"></script>
<script src="bower_components/bootstrap-sass-official/assets/javascripts/bootstrap/modal.js"></script>
<script src="bower_components/bootstrap-sass-official/assets/javascripts/bootstrap/tooltip.js"></script>
<script src="bower_components/bootstrap-sass-official/assets/javascripts/bootstrap/popover.js"></script>
<!-- endbower -->
<script src="bower_components/underscore/underscore.js"></script>
<script src="bower_components/moment/min/moment.min.js"></script>
<script src="bower_components/zeroclipboard/dist/ZeroClipboard.js"></script>
<script src="bower_components/angular-zeroclipboard.js"></script>
<!-- endbuild -->

<!-- build:js({.tmp,app}) scripts/scripts.js -->
<script src="scripts/ui-bootstrap-tpls-0.9.0.js"></script>
<script src="scripts/app.js"></script>
<script src="scripts/directiveStopWatch.js"></script>
<script src="scripts/controllerMain.js"></script>
<!-- endbuild -->

</body>
</html>
